{% extends "luzfcb_djdocuments/documento_list_base.html" %}
{% load staticfiles %}
{% load humanize %}
{% load luzfcb_djdocuments_tags %}
{% load spurl %}
{% load django_tables2 %}


{% block conteudo_app %}

    {% block cabecalho_pag %}
        <div class="page-title">
            <h3 class="pull-left">
                <i class="helper-font-24 icofont-paste color-purple-dark"></i>
                Documentos
                <small>
                    <a href="#" rel="popover" data-trigger="hover" data-html="true" data-placement="top"
                       data-content="<b>Modelo de Documentos:</b> Documentos de modelo que foram e podem ser criados para uma das defensorias que seu usuário ({{ user.username }}) está vinculado, e são utilizados para gerar outros documentos."
                       data-original-title="Modelo de Documentos">
                        <i class="elusive-question-sign color-blue"></i>
                    </a>
                </small>
            </h3>
            <form action="{{ search_url }}" method="get" id="search_field">
                <div class="controls pull-right" style="margin-top:10px;">
                    <div class="input-icon-append">
                        <span class="bold">Buscar: </span>
                        <span class="icon"><i class="icofont-search"></i></span>
                        <input name="q" class="grd-white" maxlength="30" type="text"
                               placeholder="Número ou Assunto...">
                    </div>
                </div>
            </form>
        </div>
    {% endblock %}
    {% block conteudo_pag %}
        <table class="table table-striped table-hover table-condensed">
            <thead>
            <tr>
                <th class="span1">N° Documento</th>
                <th class="span3">Assunto</th>
                <th class="span3">Tipo</th>
                <th class="span3">Defensoria</th>
                <th class="span1">Data última edição</th>
                <th class="span1">Ações</th>
            </tr>
            </thead>
            <tbody>
            {% for dado in  object_list %}
                <tr>
                    <td>
                        <i class="icofont-paste color-purple-dark"></i>
                        {#                                    {% spurl base=dado.get_preview_url add_query="no_nav=1" as url_para_visualizar_com_query %}#}
                        {#                                    <a href="{{ url_para_visualizar_com_query }}" class="btn-link">#}
                        <a href="{{ dado.get_preview_url }}" class="btn-link">
                            {{ dado.identificador_versao }}
                        </a>
                    </td>
                    <td>
                        <small>
                            {{ dado.assunto }}
                        </small>
                    </td>
                    <td>
                        <small>
                            {{ dado.tipo_documento }}
                        </small>
                    </td>
                    <td>
                        <small rel="tooltip" data-original-title="{{ dado.grupo_dono }}">
                            {{ dado.grupo_dono|truncatechars:36 }}
                        </small>
                    </td>
                    <td>
                        <small>
                            {{ dado.modificado_em }}
                        </small>
                    </td>
                    <td>
                        {% spurl base=dado.get_preview_url query='next={{ next_success_url }}' as url_para_visualizar_com_query %}
                        <a href="{{ url_para_visualizar_com_query }}" target="_blank" class="btn-link">
                            <i class="icofont-search"></i> Visualizar
                        </a>
                        {% if not dado.esta_assinado %}
                            |
                            <a href="{{ dado.get_edit_url }}" class="btn-link">
                                <i class="elusive-file-edit"></i> Editar
                            </a>

                        {% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="6">
                        <div class="alert alert-info text-center">
                            {% if is_query %}
                                <b>Nenhum item encontrado com os termos: {{ is_query|safe }}</b>
                            {% else %}
                                <b>Nenhum documento cadastrado</b>
                            {% endif %}
                        </div>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
            {% if is_query %}
                <tfoot>
                <tr>
                    <td colspan="6">
                        <div class="text-center">
                            <form action="{{ search_url }}" method="get" id="search_field">
                                <input name="q" class="grd-white" type="hidden">
                                <input type="submit" class="btn btn-warning" value="Limpar pesquisa">

                            </form>
                        </div>
                    </td>
                </tr>
                </tfoot>
            {% endif %}
        </table>

        <div class="pagination pagination-right">
            {% include 'luzfcb_djdocuments/_pagination2.html' %}
        </div>



        <div class="col-md-8 col-md-offset-2">
            {% block form_section %}{% endblock %}
        </div>
    {% endblock %}

{% endblock %}



{% block js_app %}
    {{ block.super }}
    <script type="text/javascript" src="{% static "luzfcb_djdocuments/js/luzfcb_djdocuments.js" %}"></script>
{% endblock js_app %}
