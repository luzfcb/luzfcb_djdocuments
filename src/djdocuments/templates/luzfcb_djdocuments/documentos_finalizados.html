{% extends "luzfcb_djdocuments/documentos_finalizados_base.html" %}
{% load staticfiles %}
{% load humanize %}
{% load luzfcb_djdocuments_tags %}
{% load spurl %}

{% block conteudo_app %}

    {% block cabecalho_pag %}
        <div class="page-title">
            <h3 class="pull-left">
                <i class="helper-font-24 elusive-bell color-orange"></i>
                Documentos em edição
                <small>
                    <a href="#" rel="popover" data-trigger="hover" data-html="true" data-placement="top"
                       data-content="<b>Finalizar documento</b> é a ação de conclusão do documento, o que impossibilita qualquer tipo de modificação de seu conteúdo, assinaturas ou assinantes."
                       data-original-title="Finalização de documentos">
                        <i class="elusive-question-sign color-blue"></i>
                    </a>
                </small>
            </h3>
            <form action="{{ search_url }}" method="get" id="search_field">
                <div class="controls pull-right" style="margin-top:10px;">
                    <div class="input-icon-append">
                        <span class="bold">Buscar: </span>
                        <span class="icon"><i class="icofont-search"></i></span>
                        <input name="q" class="grd-white" maxlength="30" type="text"
                               placeholder="Número do Documento...">
                    </div>
                </div>
            </form>

        </div>
    {% endblock %}

    {% block conteudo_pag %}
        <table class="table table-striped table-hover table-condensed">
            <thead>
            <tr>
                <th class="span2">N° Documento</th>
                <th class="span3">Defensoria(s) e assinante(s)</th>
                <th class="span1">Ações</th>
            </tr>
            </thead>
            <tbody>
            {% for dado in object_list %}
                <tr>
                    <td>
                        <i class="icofont-paste color-blue"></i>
                        <a href="{{ dado.get_preview_url }}" class="btn-link" rel="popover" data-trigger="hover"
                           data-placement="top" data-content="{{ dado.assunto }}"
                           data-original-title="Doc. {{ dado.identificador_versao }}">
                            {{ dado.identificador_versao }}
                        </a>
                    </td>
                    <td><!--Se tiver mais de um mostra a lista -->

                        <a href="#" class="" rel="popover" data-trigger="hover"
                           data-html="true" data-placement="top" data-content="
                                                          <div>
                                                          <ul>
                                                            {% for assinado_nome, grupo_assinante_nome in dado.assinates_nomes %}

                                                                <li>{{ assinado_nome }}
                                                                    - {{ grupo_assinante_nome }}</li>


                                                            {% endfor %}

                                                        </ul></div>" data-original-title="Defensorias e assinantes">
                            <div>
                                <ul>
                                    {% for assinado_nome, grupo_assinante_nome in dado.assinates_nomes %}

                                        <li>{{ assinado_nome }}
                                            - {{ grupo_assinante_nome }}</li>


                                    {% endfor %}

                                </ul>
                            </div>
                        </a>

                    </td>
                    <td>
                        {% spurl base=dado.get_finalizar_url query='next={{ next_success_url }}' as url_para_finalizar_com_next %}
                        <a href="{{ url_para_finalizar_com_next }}"
                           data-ajaxmodal="true"
                           data-ajaxmodal-prefetch="true"
                           class="btn-link">
                            <i class="elusive-ok-circle color-green"></i> Finalizar
                        </a> |
                        <a href="{{ dado.get_preview_url }}" target="_blank" class="btn-link">
                            <i class="icofont-search"></i> Visualizar
                        </a></td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="4">
                        <div class="alert alert-info text-center">
                            {% if is_query %}
                                <b>Nenhum item encontrado com o(s) termo(s): {{ is_query|safe }}</b>
                            {% else %}
                                <b>Nenhum documento assinado</b>
                            {% endif %}
                        </div>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
            {% if is_query %}
                <tfoot>
                <tr>
                    <td colspan="6">
                        <div class="text-center">
                            <form action="{{ search_url }}" method="get" id="search_field">
                                <input name="q" class="grd-white" type="hidden">
                                <input type="submit" class="btn btn-warning" value="Limpar pesquisa">

                            </form>
                        </div>
                    </td>
                </tr>
                </tfoot>
            {% endif %}
        </table>
        <div class="pagination pagination-right">
            {% include 'luzfcb_djdocuments/_pagination2.html' %}
        </div>


        <div class="col-md-8 col-md-offset-2">
            {% block form_section %}{% endblock %}
        </div>
    {% endblock %}

{% endblock %}
